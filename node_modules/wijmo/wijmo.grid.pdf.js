/*
    *
    * Wijmo Library 5.20172.334
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();define(["require","exports","wijmo/wijmo.pdf","wijmo/wijmo.grid","wijmo/wijmo","wijmo/wijmo.grid.pdf"],function(n,t,i,r,u,f){"use strict";function v(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.multirow}function y(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.sheet}function b(){var n;return(n=window.wijmo)&&n.olap}function o(n,t,i){var r,f,e;if(i===void 0&&(i=!1),t&&n)for(r in t)if(f=t[r],e=n[r],u.isObject(f)){if(e===undefined||!u.isObject(e)&&i)if(u.isFunction(f.clone)){n[r]=e=f.clone();continue}else n[r]=e={};u.isObject(e)&&o(n[r],f,i)}else(e===undefined||i&&f!==undefined)&&(n[r]=f);return n}var e,p,w,s,c;Object.defineProperty(t,"__esModule",{value:!0});window.wijmo=window.wijmo||{};window.wijmo.grid=window.wijmo.grid||{};window.wijmo.grid.pdf=f,function(n){n[n.ActualSize=0]="ActualSize";n[n.PageWidth=1]="PageWidth";n[n.SinglePage=2]="SinglePage"}(e=t.ScaleMode||(t.ScaleMode={})),function(n){n[n.All=0]="All";n[n.Selection=1]="Selection"}(p=t.ExportMode||(t.ExportMode={}));w=function(n){function t(t,i,r,f,e,o,s,h,c){var l=n.call(this,t,i)||this;return l.cancelBorders=!1,l._cell=u.asType(r,HTMLElement,!0),l._canvas=f,l._clientRect=e,l._contentRect=o,l._textTop=s,l._style=h,l._getFormattedCell=c,l}return __extends(t,n),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientRect",{get:function(){return this._clientRect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!0,configurable:!0}),t.prototype.getFormattedCell=function(){return u.asFunction(this._getFormattedCell)()},Object.defineProperty(t.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textTop",{get:function(){return this._textTop},enumerable:!0,configurable:!0}),t}(r.CellRangeEventArgs);t.PdfFormatItemEventArgs=w;c=function(){function n(){}return n.draw=function(n,t,r,f,s){u.assert(!!n,'The flex argument cannot be null.');u.assert(!!t,'The doc argument cannot be null.');var h=o({},s);o(h,this.DefaultDrawSettings);h.scaleMode=r==null?e.ActualSize:f==null?e.PageWidth:e.SinglePage;try{h.recalculateStarWidths&&n.columns._updateStarSizes(i.ptToPx(t.width));this._draw(n,t,null,r,f,h)}finally{h.recalculateStarWidths&&n.invalidate(!0)}},n.drawToPosition=function(n,t,r,f,s,h){u.assert(!!n,'The flex argument cannot be null.');u.assert(!!t,'The doc argument cannot be null.');u.assert(!!r,'The point argument cannot be null.');var c=o({},h);o(c,this.DefaultDrawSettings);c.scaleMode=f==null?e.ActualSize:s==null?e.PageWidth:e.SinglePage;try{c.recalculateStarWidths&&n.columns._updateStarSizes(i.ptToPx(t.width));this._draw(n,t,r,f,s,c)}finally{c.recalculateStarWidths&&n.invalidate(!0)}},n.export=function(n,t,r){var e,f;u.assert(!!n,'The flex argument cannot be null.');u.assert(!!t,'The fileName argument cannot be empty.');r=o({},r);o(r,this.DefaultExportSettings);e=r.documentOptions.ended;r.documentOptions.ended=function(n,r){e&&e.apply(f,[n,r])===!1||i.saveBlob(r.blob,t)};f=new i.PdfDocument(r.documentOptions);try{r.recalculateStarWidths&&n.columns._updateStarSizes(i.ptToPx(f.width));this._draw(n,f,null,null,null,r);f.end()}finally{r.recalculateStarWidths&&n.invalidate(!0)}},n._draw=function(n,t,i,f,e,o){var nt=i!=null,l=new u.Size(t.width,t.height),c,k;i||(i=new u.Point(0,t.y));u.isArray(o.embeddedFonts)&&o.embeddedFonts.forEach(function(n){t.registerFont(n)});var d=h.getSelection(n,o.exportMode),g=this._getGridRenderer(n,d,!1,this.BorderWidth,null,!0),a=new u.Rect(i.x||0,i.y||0,f||l.width,e||l.height),v=this._getScaleFactor(g,o.scaleMode,a),y=this._getPages(g,d,a,o,nt,v);s=document.createElement('div');s.setAttribute(r.FlexGrid._WJS_MEASURE,'true');s.style.visibility='hidden';n.hostElement.appendChild(s);try{for(c=0;c<y.length;c++){c>0&&t.addPage();var p=y[c],w=p.pageCol===0?a.left:0,b=p.pageRow===0?a.top:0;t.saveState();t.paths.rect(0,0,l.width,l.height).clip();t.scale(v,v,new u.Point(w,b));t.translate(w,b);k=this._getGridRenderer(n,p.range,o.repeatMergedValuesAcrossPages,this.BorderWidth,o.styles,c===y.length-1);k.render(t,o);t.restoreState();t.x=w;t.y=b+k.renderSize.height*v}}finally{s&&(s.parentElement.removeChild(s),s=null)}},n._getScaleFactor=function(n,t,i){var u=1,f,r;return t===e.ActualSize?u:(f=n.renderSize,t===e.SinglePage?(r=Math.min(i.width/f.width,i.height/f.height),r<1&&(u=r)):(r=i.width/f.width,r<1&&(u=r)),u)},n._getPages=function(n,t,r,u,f,o){var ht=this,h=[],c=[],p=i.pxToPt,w=n.flex,nt=n.showColumnHeader,tt=n.showRowHeader,b=nt?p(w.columnHeaders.height):0,d=tt?p(w.rowHeaders.width):0,yt=u.scaleMode===e.ActualSize||u.scaleMode===e.PageWidth,pt=u.scaleMode===e.ActualSize,wt=(r.width-r.left)*(1/o),bt=(r.height-r.top)*(1/o),kt=r.width*(1/o),dt=r.height*(1/o),a=b,v=d,ct=f&&u.scaleMode==e.ActualSize,it,y,rt,ft,g,et,s,l,st,vt;if(yt&&(it=0,t.forEach(w.cells,function(n,t,i,r){var f=h.length?dt:bt,u;k.isRenderableRow(n)&&(u=p(n.renderHeight),it++,a+=u,(nt||it>1)&&(a-=ht.BorderWidth),a>f&&(b+u>f||ct?(h.push(r),a=b):(h.push(r-1),a=b+u),nt&&(a-=ht.BorderWidth)))})),y=t.length()-1,y<0&&(y=0),h.length&&h[h.length-1]===y||h.push(y),pt)for(rt=0,s=t.leftCol;s<=t.rightCol;s++)ft=w.columns[s],ft.isVisible&&(g=p(ft.renderWidth),et=c.length?kt:wt,rt++,v+=g,(tt||rt>1)&&(v-=this.BorderWidth),v>et&&(d+g>et||ct?(c.push(s),v=d):(c.push(s-1),v=d+g),tt&&(v-=this.BorderWidth)));c.length&&c[c.length-1]===t.rightCol||c.push(t.rightCol);var lt=[],ot=!1,at=1,gt=f&&u.maxPages>0?1:u.maxPages;for(s=0;s<h.length&&!ot;s++)for(l=0;l<c.length&&!ot;l++,at++)(ot=at>gt)||(st=s==0?0:h[s-1]+1,vt=l==0?t.leftCol:c[l-1]+1,lt.push(new ut(t.subrange(st,h[s]-st+1,vt,c[l]),l,s)));return lt},n._getGridRenderer=function(n,t,i,r,u,f){var e=v()&&n instanceof v().MultiRow&&nt||y()&&n instanceof y().FlexSheet&&g||b()&&n instanceof b().PivotGrid&&tt||a;return new e(n,t,i,r,u,f)},n}();c.BorderWidth=1;c.DefaultDrawSettings={maxPages:Number.MAX_VALUE,exportMode:p.All,repeatMergedValuesAcrossPages:!0,recalculateStarWidths:!0,styles:{cellStyle:{font:new i.PdfFont,padding:1.5,verticalAlign:'middle'},headerCellStyle:{font:{weight:'bold'}}}};c.DefaultExportSettings=o({scaleMode:e.PageWidth,documentOptions:{compress:!1,pageSettings:{margins:{left:36,right:36,top:18,bottom:18}}}},c.DefaultDrawSettings);t.FlexGridPdfConverter=c;var a=function(){function n(n,t,i,u,f,e){this._flex=n;this._borderWidth=u;this._lastPage=e;this._topLeft=new l(this,n.topLeftCells,this.showRowHeader&&this.showColumnHeader?new h(n,[new r.CellRange(0,0,n.topLeftCells.rows.length-1,n.topLeftCells.columns.length-1)]):new h(n,[]),i,u,f);this._rowHeader=new l(this,n.rowHeaders,this.showRowHeader?t.clone(0,n.rowHeaders.columns.length-1):new h(n,[]),i,u,f);this._columnHeader=new l(this,n.columnHeaders,this.showColumnHeader?new h(n,[new r.CellRange(0,t.leftCol,n.columnHeaders.rows.length-1,t.rightCol)]):new h(n,[]),i,u,f);this._cells=new l(this,n.cells,t,i,u,f);this._bottomLeft=new l(this,n.bottomLeftCells,this.showRowHeader&&this.showColumnFooter?new h(n,[new r.CellRange(0,0,n.bottomLeftCells.rows.length-1,n.bottomLeftCells.columns.length-1)]):new h(n,[]),i,u,f);this._columnFooter=new l(this,n.columnFooters,this.showColumnFooter?new h(n,[new r.CellRange(0,t.leftCol,n.columnFooters.rows.length-1,t.rightCol)]):new h(n,[]),i,u,f)}return n.prototype.render=function(n,t){var r=Math.max(0,Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)-this._borderWidth),i=Math.max(0,Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)-this._borderWidth);this._topLeft.render(n,0,0,t);this._rowHeader.render(n,0,i,t);this._columnHeader.render(n,r,0,t);this._cells.render(n,r,i,t);i=Math.max(0,i+this._cells.renderSize.height-this._borderWidth);this._bottomLeft.render(n,0,i,t);this._columnFooter.render(n,r,i,t)},Object.defineProperty(n.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"renderSize",{get:function(){var n=Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)+Math.max(this._rowHeader.renderSize.height,this._cells.renderSize.height)+Math.max(this._bottomLeft.renderSize.height,this._columnFooter.renderSize.height),t=Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)+Math.max(this._columnHeader.renderSize.width,this._cells.renderSize.width);return this._columnHeader.visibleRows>0&&(n-=this._borderWidth),this._columnFooter.visibleRows>0&&(n-=this._borderWidth),this._rowHeader.visibleColumns>0&&(t-=this._borderWidth),new u.Size(t,n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showColumnHeader",{get:function(){return!!(this._flex.headersVisibility&r.HeadersVisibility.Column)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showRowHeader",{get:function(){return!!(this._flex.headersVisibility&r.HeadersVisibility.Row)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showColumnFooter",{get:function(){return this._lastPage&&this._flex.columnFooters.rows.length>0},enumerable:!0,configurable:!0}),n.prototype.alignMergedTextToTheTopRow=function(){return!1},n.prototype.getCellValue=function(n,t,i){return n.getCellData(i,t,!0)},n.prototype.getColumn=function(n,t){return n.columns[t]},n.prototype.isAlternatingRow=function(n){return n.index%2!=0},n.prototype.isMergeableCell=function(){return!0},n}(),g=function(n){function t(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return __extends(t,n),t.prototype.getCellValue=function(t,i,u){return t.cellType===r.CellType.Cell?t.rows[u]instanceof y().HeaderRow?this.flex.columnHeaders.getCellData(u,i,!0):this.flex.getCellValue(u,i,!0):n.prototype.getCellValue.call(this,t,i,u)},Object.defineProperty(t.prototype,"showColumnHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showRowHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showColumnFooter",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(a),nt=function(n){function t(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return __extends(t,n),t.prototype.getColumn=function(n,t,i){return this.flex.getBindingColumn(n,i,t)},t.prototype.isAlternatingRow=function(t){return t instanceof v()._MultiRow?t.dataIndex%2!=0:n.prototype.isAlternatingRow.call(this,t)},t.prototype.isMergeableCell=function(){return!0},t}(a),tt=function(n){function t(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return __extends(t,n),t.prototype.alignMergedTextToTheTopRow=function(n){return!this.flex.centerHeadersVertically&&(n.cellType===r.CellType.ColumnHeader||n.cellType===r.CellType.RowHeader)},t}(a),k=function(){function n(n,t){this._panel=n;this._range=t.clone()}return n.isRenderableRow=function(n){return n.isVisible&&!(n instanceof r._NewRowTemplate)},Object.defineProperty(n.prototype,"visibleRows",{get:function(){var n=this;return this._visibleRows==null&&(this._visibleRows=0,this._range.forEach(this._panel,function(t){n.isRenderableRow(t)&&n._visibleRows++})),this._visibleRows},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visibleColumns",{get:function(){if(this._visibleColumns==null&&(this._visibleColumns=0,this._range.isValid))for(var n=this._range.leftCol;n<=this._range.rightCol;n++)this._panel.columns[n].isVisible&&this._visibleColumns++;return this._visibleColumns},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){if(this._size==null){var n=this._range.getRenderSize(this._panel);this._size=new u.Size(i.pxToPt(n.width),i.pxToPt(n.height))}return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0}),n.prototype.isRenderableRow=function(t){return n.isRenderableRow(t)},n}(),l=function(n){function t(t,i,r,u,f,e){var o=n.call(this,i,r)||this;return o._gr=t,o._repeatMergedValues=u,o._borderWidth=f,o._styles=e,o}return __extends(t,n),Object.defineProperty(t.prototype,"gr",{get:function(){return this._gr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return this._styles},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderSize",{get:function(){return this._renderSize==null&&(this._renderSize=this.size.clone(),this.visibleColumns>1&&(this._renderSize.width-=this._borderWidth*(this.visibleColumns-1)),this.visibleRows>1&&(this._renderSize.height-=this._borderWidth*(this.visibleRows-1))),this._renderSize},enumerable:!0,configurable:!0}),t.prototype.getRangeWidth=function(n,t){for(var e,r=0,u=0,o=this.panel,f=n;f<=t;f++)e=o.columns[f],e.isVisible&&(u++,r+=e.renderWidth);return r=i.pxToPt(r),u>1&&(r-=this._borderWidth*(u-1)),r},t.prototype.getRangeHeight=function(n,t){for(var e,r=0,u=0,o=this.panel,f=n;f<=t;f++)e=o.rows[f],this.isRenderableRow(e)&&(u++,r+=e.renderHeight);return r=i.pxToPt(r),u>1&&(r=r-this._borderWidth*(u-1)),r},t.prototype.render=function(n,t,i,r){var f=this,e=this.range,s=this.panel,l=new rt(this._gr.flex),c=new d(s,0,0,0,0),a=new it(this,n,r,this._borderWidth),o,h;if(e.isValid){for(o={},h=e.leftCol;h<=e.rightCol;h++)o[h]=i;e.forEach(s,function(n,i,r){var nt,h,w,v,g;if(f.isRenderableRow(n))for(nt=t,h=e.leftCol;h<=e.rightCol;h++){var tt=f.gr.getColumn(s,h,r),y=undefined,p=undefined,b,k=!1,d=undefined;if(tt.isVisible){if(w=f._getCellValue(h,r),v=null,f.gr.isMergeableCell(tt,n)&&(v=l.getMergedRange(s,r,h)))if(c.copyFrom(v),v.topRow!==v.bottomRow)v.firstVisibleRow===r||r===i.topRow?(k=!0,b=f._repeatMergedValues?w:v.firstVisibleRow===r?w:'',y=f.getRangeHeight(r,Math.min(v.bottomRow,i.bottomRow)),p=f.getRangeWidth(h,h)):p=f.getRangeWidth(h,h);else for(k=!0,b=f._repeatMergedValues?w:h===v.leftCol?w:'',y=f.getRangeHeight(r,r),p=f.getRangeWidth(Math.max(e.leftCol,v.leftCol),Math.min(e.rightCol,v.rightCol)),d=Math.min(e.rightCol,v.rightCol),g=h+1;g<=d;g++)o[g]+=y-f._borderWidth;else c.setRange(r,h,r,h),k=!0,b=w,y=f.getRangeHeight(r,r),p=f.getRangeWidth(h,h);k&&a.renderCell(b,n,tt,c,new u.Rect(nt,o[h],p,y));y&&(o[h]+=y-f._borderWidth);p&&(nt+=p-f._borderWidth);d&&(h=d)}}})}},t.prototype._getCellValue=function(n,t){var u=this.panel,o=this.gr.getCellValue(u,n,t),i,f,e;return o||u.cellType!==r.CellType.Cell||(i=u.rows[t],i instanceof r.GroupRow&&i.dataItem&&i.dataItem.groupDescription&&n===u.columns.firstVisibleIndex&&(f=i.dataItem.groupDescription.propertyName,e=u.columns.getColumn(f),e&&e.header&&(f=e.header),o=f+': '+i.dataItem.name+' ('+i.dataItem.items.length+' items)')),o},t}(k),it=function(){function n(n,t,i,r){this._pr=n;this._area=t;this._settings=i||{};this._borderWidth=r}return n.prototype.renderCell=function(n,t,f,e,o){var a,y=t.grid,v=this._pr.panel,g=function(){var n=e.topRow,t=e.leftCol,i=v.getCellElement(n,t);return i||(s.style.cssText='',s.className='',y.cellFactory.updateCell(v,n,t,s)),i||s},nt=function(n){return n.className=n.className.replace('wj-state-selected',''),n.className=n.className.replace('wj-state-multi-selected',''),window.getComputedStyle(n)},b=!!this._settings.customCellContent,p=null,h=this._getMergedCellStyle(t),c,l,k,d;if(b&&(p=g()),b&&(n=p.textContent.trim()),b&&(c=nt(p),h.color=c.color,h.backgroundColor=c.backgroundColor,h.borderColor=c.borderColor||c.borderRightColor||c.borderBottomColor||c.borderLeftColor||c.borderTopColor,h.font=new i.PdfFont(c.fontFamily,i._asPt(c.fontSize,!0,undefined),c.fontStyle,c.fontWeight),h.textAlign=c.textAlign),h.boxSizing='border-box',h.borderWidth=this._borderWidth,h.borderStyle='solid',h.textAlign||t instanceof r.GroupRow&&!f.aggregate||(h.textAlign=f.getAlignment()),v.cellType===r.CellType.Cell&&y.rows.maxGroupLevel>=0&&e.leftCol===y.columns.firstVisibleIndex){var tt=t instanceof r.GroupRow?Math.max(t.level,0):y.rows.maxGroupLevel+1,it=i._asPt(h.paddingLeft||h.padding),rt=i.pxToPt(tt*y.treeIndent);h.paddingLeft=it+rt}l=this._measureCell(n,f,t,v,h,o);k=e.rowSpan>1&&e.visibleRowsCount>1&&this._pr.gr.alignMergedTextToTheTopRow(v);k&&(d=new u.Rect(l.contentRect.left,l.contentRect.top,l.contentRect.width,l.contentRect.height/(e.visibleRowsCount||1)),l.textRect=this._calculateTextRect(n,f,t,v,d,h));u.isFunction(this._settings.formatItem)&&(a=new w(v,e,p,this._area,l.rect,l.contentRect,l.textRect.top,h,function(){return p||g()}),a.data=n,this._settings.formatItem(a),a.data!==n&&(n=u.asString(a.data),l.textRect=this._calculateTextRect(n,f,t,v,k?d:l.contentRect,h)));this._renderCell(n,t,f,e,l,h,a?!a.cancel:!0,a?!a.cancelBorders:!0)},n.prototype._renderCell=function(n,t,i,r,u,f,e,o){if(e||o){var s=this._pr.panel,h=s.grid;this._isBooleanCell(n,i,t,s)?this._renderBooleanCell(n,u,f,e,o):this._renderTextCell(n,u,f,e,o)}},n.prototype._getMergedCellStyle=function(n){var t=this._pr.styles,i=o({},t.cellStyle),u=this._pr.panel;switch(u.cellType){case r.CellType.Cell:this._isGroupRow(n)?o(i,t.groupCellStyle,!0):this._pr.gr.isAlternatingRow(n)&&o(i,t.altCellStyle,!0);break;case r.CellType.ColumnHeader:case r.CellType.RowHeader:case r.CellType.TopLeft:case r.CellType.BottomLeft:o(i,t.headerCellStyle,!0);break;case r.CellType.ColumnFooter:o(i,t.headerCellStyle,!0);o(i,t.footerCellStyle,!0)}return i},n.prototype._isBooleanCell=function(n,t,i,f){return t.dataType===u.DataType.Boolean&&f.cellType===r.CellType.Cell&&!this._isGroupRow(i)&&this._isBoolean(n)},n.prototype._isBoolean=function(n){var t=u.isString(n)&&n.toLowerCase();return t==='true'||t==='false'||n===!0||n===!1},n.prototype._isGroupRow=function(n){return n instanceof r.GroupRow&&n.hasChildren},n.prototype._measureCell=function(n,t,r,f,e,o){this._decompositeStyle(e);var y=o.left,p=o.top,h=o.height,c=o.width,v=this._parseBorder(e),w=v.left.width,b=v.top.width,nt=v.bottom.width,tt=v.right.width,s=this._parsePadding(e),l=0,a=0,k=0,d=0;if(e.boxSizing==='content-box'||e.boxSizing===undefined)l=s.top+h+s.bottom,a=s.left+c+s.right,k=h,d=c;else{if(e.boxSizing==='border-box')i._IE&&e instanceof CSSStyleDeclaration?(l=s.top+s.bottom+h,a=s.left+s.right+c):(l=h-b-nt,a=c-w-tt);else throw'Invalid value: '+e.boxSizing;k=l-s.top-s.bottom;d=a-s.left-s.right}var o=new u.Rect(y,p,c,h),it=new u.Rect(y+w,p+b,a,l),g=new u.Rect(y+w+s.left,p+b+s.top,d,k),rt=this._calculateTextRect(n,t,r,f,g,e);return{rect:o,clientRect:it,contentRect:g,textRect:rt}},n.prototype._decompositeStyle=function(n){if(n){var t;(t=n.borderColor)&&(n.borderLeftColor||(n.borderLeftColor=t),n.borderRightColor||(n.borderRightColor=t),n.borderTopColor||(n.borderTopColor=t),n.borderBottomColor||(n.borderBottomColor=t));(t=n.borderWidth)&&(n.borderLeftWidth||(n.borderLeftWidth=t),n.borderRightWidth||(n.borderRightWidth=t),n.borderTopWidth||(n.borderTopWidth=t),n.borderBottomWidth||(n.borderBottomWidth=t));(t=n.borderStyle)&&(n.borderLeftStyle||(n.borderLeftStyle=t),n.borderRightStyle||(n.borderRightStyle=t),n.borderTopStyle||(n.borderTopStyle=t),n.borderBottomStyle||(n.borderBottomStyle=t));(t=n.padding)&&(n.paddingLeft||(n.paddingLeft=t),n.paddingRight||(n.paddingRight=t),n.paddingTop||(n.paddingTop=t),n.paddingBottom||(n.paddingBottom=t))}},n.prototype._parseBorder=function(n){var t={left:{width:0},top:{width:0},bottom:{width:0},right:{width:0}};return n.borderLeftStyle!=='none'&&(t.left={width:i._asPt(n.borderLeftWidth),style:n.borderLeftStyle,color:n.borderLeftColor}),n.borderTopStyle!=='none'&&(t.top={width:i._asPt(n.borderTopWidth),style:n.borderTopStyle,color:n.borderTopColor}),n.borderBottomStyle!=='none'&&(t.bottom={width:i._asPt(n.borderBottomWidth),style:n.borderBottomStyle,color:n.borderBottomColor}),n.borderRightStyle!=='none'&&(t.right={width:i._asPt(n.borderRightWidth),style:n.borderRightStyle,color:n.borderRightColor}),t},n.prototype._parsePadding=function(n){return{left:i._asPt(n.paddingLeft),top:i._asPt(n.paddingTop),bottom:i._asPt(n.paddingBottom),right:i._asPt(n.paddingRight)}},n.prototype._renderEmptyCell=function(n,t,r,u){var e=n.rect.left,o=n.rect.top,h=n.clientRect.width,c=n.clientRect.height,d=n.rect.height,g=n.rect.width,f=n.clientRect.left-n.rect.left,s=n.clientRect.top-n.rect.top,l=n.rect.top+n.rect.height-(n.clientRect.top+n.clientRect.height),a=n.rect.left+n.rect.width-(n.clientRect.left+n.clientRect.width),y,p;if(u&&(f||a||l||s)){var v=t.borderLeftColor||t.borderColor,w=t.borderRightColor||t.borderColor,b=t.borderTopColor||t.borderColor,k=t.borderBottomColor||t.borderColor;f&&s&&l&&a&&f===a&&f===l&&f===s&&v===w&&v===k&&v===b?(y=f,p=y/2,this._area.paths.rect(e+p,o+p,h+y,c+y).stroke(new i.PdfPen(v,y))):(f&&this._area.paths.polygon([[e,o],[e+f,o+s],[e+f,o+s+c],[e,o+s+c+l]]).fill(v),s&&this._area.paths.polygon([[e,o],[e+f,o+s],[e+f+h,o+s],[e+f+h+a,o]]).fill(b),a&&this._area.paths.polygon([[e+f+h+a,o],[e+f+h,o+s],[e+f+h,o+s+c],[e+f+h+a,o+s+c+l]]).fill(w),l&&this._area.paths.polygon([[e,o+s+c+l],[e+f,o+s+c],[e+f+h,o+s+c],[e+f+h+a,o+s+c+l]]).fill(k))}r&&t.backgroundColor&&h>0&&c>0&&this._area.paths.rect(e+f,o+s,h,c).fill(t.backgroundColor)},n.prototype._renderBooleanCell=function(n,t,r,f,e){if(this._renderEmptyCell(t,r,f,e),f){var c=.5,a=t.textRect.left,v=t.textRect.top,o=t.textRect.height;if(this._area.paths.rect(a,v,o,o).fillAndStroke(u.Color.fromRgba(255,255,255),new i.PdfPen(undefined,c)),u.changeType(n,u.DataType.Boolean,'')===!0){var l=o/20,s=o-c-l*2,h=o/8;this._area._pdfdoc.saveState();this._area.translate(a+c/2+l,v+c/2+l).paths.moveTo(h/2,s*.6).lineTo(s-s*.6,s-h).lineTo(s-h/2,h/2).stroke(new i.PdfPen(undefined,h));this._area._pdfdoc.restoreState()}}},n.prototype._renderTextCell=function(n,t,r,u,f){(this._renderEmptyCell(t,r,u,f),u)&&n&&this._area.drawText(n,t.textRect.left,t.textRect.top,{brush:r.color,font:r.font,height:t.textRect.height,width:t.textRect.width,align:r.textAlign==='center'?i.PdfTextHorizontalAlign.Center:r.textAlign==='right'?i.PdfTextHorizontalAlign.Right:r.textAlign==='justify'?i.PdfTextHorizontalAlign.Justify:i.PdfTextHorizontalAlign.Left})},n.prototype._calculateTextRect=function(n,t,i,r,u,f){var e=u.clone(),s,o;if(this._isBooleanCell(n,t,i,r)){s=this._area.measureText('A',f.font,{width:Infinity}).size.height;switch(f.verticalAlign){case'middle':e.top=u.top+u.height/2-s/2;break;case'bottom':e.top=u.top+u.height-s}switch(f.textAlign){case'justify':case'center':e.left=u.left+u.width/2-s/2;break;case'right':e.left=u.left+u.width-s}e.height=e.width=s}else if(e.height>0&&e.width>0)switch(f.verticalAlign){case'bottom':o=this._area.measureText(n,f.font,{height:e.height,width:e.width});o.size.height<e.height&&(e.top+=e.height-o.size.height,e.height=o.size.height);break;case'middle':o=this._area.measureText(n,f.font,{height:e.height,width:e.width});o.size.height<e.height&&(e.top+=e.height/2-o.size.height/2,e.height=o.size.height)}return e},n}(),rt=function(){function n(n){this._columns={};this._flex=n}return n.prototype.getMergedRange=function(n,t,i){var r=this._columns[i],u;return r&&t>=r.topRow&&t<=r.bottomRow?r:(u=this._flex.getMergedRange(n,t,i,!1),this._columns[i]=u?new d(n,u):null)},n}(),d=function(n){function t(t,i,u,f,e){var o=this,s;o=i instanceof r.CellRange?n.call(this,i.row,i.col,i.row2,i.col2)||this:n.call(this,i,u,f,e)||this;o.firstVisibleRow=-1;o.visibleRowsCount=0;var c=o.topRow,l=o.bottomRow,h=t.rows.length;if(h>0)for(s=c;s<=l&&s<h;s++)t.rows[s].isVisible&&(o.firstVisibleRow<0&&(o.firstVisibleRow=s),o.visibleRowsCount++);return o}return __extends(t,n),t.prototype.copyFrom=function(n){this.setRange(n.row,n.col,n.row2,n.col2);this.firstVisibleRow=n.firstVisibleRow;this.visibleRowsCount=n.visibleRowsCount},t}(r.CellRange),h=function(){function n(n,t){this._flex=n;this._ranges=t||[]}return n.getSelection=function(t,i){var f=[],o,e,u,s;if(i===p.All)f.push(new r.CellRange(0,0,t.rows.length-1,t.columns.length-1));else{o=t.selection;switch(t.selectionMode){case r.SelectionMode.Cell:case r.SelectionMode.CellRange:f.push(o);break;case r.SelectionMode.Row:f.push(new r.CellRange(o.topRow,0,o.topRow,t.cells.columns.length-1));break;case r.SelectionMode.RowRange:f.push(new r.CellRange(o.topRow,0,o.bottomRow,t.cells.columns.length-1));break;case r.SelectionMode.ListBox:for(e=-1,u=0;u<t.rows.length;u++)s=t.rows[u],s.isSelected?(e<0&&(e=u),u===t.rows.length-1&&f.push(new r.CellRange(e,0,u,t.cells.columns.length-1))):(e>=0&&f.push(new r.CellRange(e,0,u-1,t.cells.columns.length-1)),e=-1)}}return new n(t,f)},n.prototype.length=function(){for(var n,i=0,t=0;t<this._ranges.length;t++)n=this._ranges[t],n.isValid&&(i+=n.bottomRow-n.topRow+1);return i},Object.defineProperty(n.prototype,"isValid",{get:function(){return this._ranges.length&&this._ranges[0].isValid},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftCol",{get:function(){return this._ranges.length?this._ranges[0].leftCol:-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightCol",{get:function(){return this._ranges.length?this._ranges[0].rightCol:-1},enumerable:!0,configurable:!0}),n.prototype.clone=function(t,i){for(var r,f=[],u=0;u<this._ranges.length;u++)r=this._ranges[u].clone(),arguments.length>0&&(r.col=t),arguments.length>1&&(r.col2=i),f.push(r);return new n(this._flex,f)},n.prototype.getRenderSize=function(n){for(var r,t=new u.Size(0,0),i=0;i<this._ranges.length;i++)r=this._ranges[i].getRenderSize(n),t.width=Math.max(t.width,r.width),t.height+=r.height;return t},n.prototype.forEach=function(n,t){for(var i,r,f=0,u=0;u<this._ranges.length;u++)if(i=this._ranges[u],i.isValid)for(r=i.topRow;r<=i.bottomRow;r++)t(n.rows[r],i,r,f++)},n.prototype.subrange=function(t,i,u,f){var l=[],o,s,h,e;if(t>=0&&i>0)for(o=0,s=0,h=0;h<this._ranges.length&&i>0;h++,o=s+1)if(e=this._ranges[h],s=o+(e.bottomRow-e.topRow),!(t>s)){var c=t>o?e.topRow+(t-o):e.topRow,a=Math.min(e.bottomRow,c+i-1),v=arguments.length>2?u:e.leftCol,y=arguments.length>2?f:e.rightCol;l.push(new r.CellRange(c,v,a,y));i-=a-c+1}return new n(this._flex,l)},n}(),ut=function(){function n(n,t,i){this._col=t;this._row=i;this._range=n}return Object.defineProperty(n.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageCol",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageRow",{get:function(){return this._row},enumerable:!0,configurable:!0}),n}()})